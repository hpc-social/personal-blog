<!DOCTYPE html>
<html lang="en-US" data-theme="light">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0,viewport-fit=cover">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Spark on Supercomputers- A Few Notes - hpc.social - Aggregated Personal Blog</title>
        <meta name="description" content="Shared personal experiences and stories">
        <meta name="keywords" content="">
        <base href="https://hpc.social/personal-blog" />
        
        <meta content="2014-06-08T03:34:00-06:00" property="article:published_time">
        <meta content="https://hpc.social/about/" property="article:author">
          
        <meta property="og:site_name" content="hpc.social - Aggregated Personal Blog">
        <meta property="og:type" content="article" />
        <meta property="og:url" content="https://hpc.social/personal-blog/2014/spark-on-supercomputers-a-few-notes/"/>
        <meta property="og:title" content="Spark on Supercomputers- A Few Notes - hpc.social - Aggregated Personal Blog" />
        <meta property="og:description" content="Shared personal experiences and stories" />
        <meta property="og:image" content="https://hpc.social/personal-blog/assets/images/hpc-social-blue.png"/>
        <meta name="twitter:site" content="@hpc_social" />
        <meta name="twitter:creator" content="@hpc_social" /> 
        <meta name="twitter:card" content="summary"/>
        <meta property="twitter:title" content="Spark on Supercomputers- A Few Notes - hpc.social - Aggregated Personal Blog" />
        <meta property="twitter:description" content="Shared personal experiences and stories" />
        <meta property="twitter:image" content="https://hpc.social/personal-blog/assets/images/hpc-social-blue.png" />
        <link rel="stylesheet" href="/personal-blog/assets/css/highlight.css">

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Catamaran:wght@300&display=swap" rel="stylesheet"> 

        <link rel="stylesheet" href="/personal-blog/assets/css/style.css">
        <link rel="shortcut icon" href="/personal-blog/assets/images/hpc-social-blue.png" />
        <link rel="alternate" type="application/atom+xml" title="hpc.social - Aggregated Personal Blog" href="https://hpc.social/personal-blog/atom.xml">
        <link rel="alternate" type="application/json" title="hpc.social - Aggregated Personal Blog" href="https://hpc.social/personal-blog/feed.json" />
        <link rel="sitemap" type="application/xml" title="sitemap" href="https://hpc.social/personal-blog/sitemap.xml" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebSite","author":{"@type":"Person","name":"hpc.social"},"description":"Shared personal experiences and stories","headline":"hpc.social - Aggregated Personal Blog","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://hpc.social/personal-blog/assets/images/hpc-social-blue.png"},"name":"hpc.social"},"sameAs":["https://twitter.com/","https://github.com/"],"url":"https://hpc.social/personal-blog"}</script>
    </head>
<body>

<div class="container">
	<div class="profile">
		<a href="https://hpc.social/personal-blog/"><img src="/personal-blog/assets/images/hpc-social-blue.png" class="profile-image"></a>
		<div class="profile-about">
			<h2 style="margin-bottom: 0; font-weight: 700;">hpc.social</h2>
			
			
				<a href="https://twitter.com/hpc_social" target="_blank"><img src="/personal-blog/assets/images/icon/twitter.svg" class="social-icon"></a>
			
			
			
			
				<a href="https://github.com/hpc-social" target="_blank"><img src="/personal-blog/assets/images/icon/github.svg" class="social-icon"></a>
			
			
			<a href="/personal-blog/about/"><img src="/personal-blog/assets/images/icon/me.svg" class="social-icon"></a>
			<br>
			High Performance Computing <br> Practitioners <br> and friends /#hpc
			<br>
			<div class="mode" id="mode-switcher" onclick="toggleNightMode();">
				<span></span>
			</div>
		</div>
	</div>
	
<div class="post-header">
	<div class="post-date">08.06.2014  &middot; <span class="reading-time" title="Estimated read time">
  
   12 mins  read </span>
</div>
	<div class="post-share">
		Share:&nbsp; 
		<a href="https://twitter.com/intent/tweet?source=tweetbutton&amp;original_referer=https://hpc.social/spark-on-supercomputers-a-few-notes&amp;text=Spark on Supercomputers- A Few Notes - https://hpc.social/spark-on-supercomputers-a-few-notes" target="_blank"><img src="https://hpc.social/personal-blog/assets/images/icon/twitter.svg" class="social-icon"></a>
	</div>
</div>

<div class="tags-container" style="padding:10px; font-size:18px; font-style:italic">
        This is a crosspost from &nbsp; <a target="_blank" href="https://glennklockwood.blogspot.com/search/label/hpc">Glenn K. Lockwood</a>&nbsp;Personal thoughts and opinions of a supercomputing enthusiast.&nbsp;See the original post&nbsp;<a target="_blank" href="https://glennklockwood.blogspot.com/2014/06/spark-on-supercomputers-few-notes.html">here</a>.</div>

<div class="blog-post-content">
	<h1>Spark on Supercomputers- A Few Notes</h1>
	<p>I’ve been working with Apache Spark quite a bit lately in an effort to bring it into the fold as a viable tool for solving some of the data-intensive problems encountered in supercomputing.  I’ve already added support for <a href="https://github.com/glennklockwood/myhadoop/tree/spark">provisioning Spark clusters to a branch of the myHadoop framework</a> I maintain so that Slurm, Torque, and SGE users can begin playing with it, and as a result of these efforts, I’ve discovering a number of interesting issues with Spark running on traditional supercomputers.<br /><br />At this point in time, Spark is very rough around the edges.  The core implementation of resilient distributed datasets are all there and work wonderfully, but I’ve found that it doesn’t take long to start discovering bugs and half-implemented features that can get very confusing very quickly.  Perhaps half of the problems I’ve faced are the result of the fact that I have been trying to run Spark in non-traditional ways (for example, over hosts’ TCP over InfiniBand interfaces and with non-default config directories), and although the documentation claims to support all of the features necessary to make this possible, the reality is a bit different.<br /><br />What follows are just some incoherent notes I’ve taken while porting Spark to the myHadoop framework.  Spark is rapidly developing and it is constantly improving, so I hope this post becomes outdated as the Spark developers make the framework more robust.<br /><br />&lt;h2&gt;Control Script Problems&lt;/h2&gt;Hadoop and Spark both ship with “control scripts” or “<a href="http://spark.apache.org/docs/0.9.1/spark-standalone.html#cluster-launch-scripts">cluster launch scripts</a>” that facilitate the starting and stopping of the entire cluster of daemons.  At the highest level, this includes start-all.sh and stop-all.sh, which make calls to start-dfs.sh and start-yarn.sh (in Hadoop) and start-master.sh and start-slaves.sh.  In Hadoop, these scripts work wonderfully, but Spark’s implementation of these control scripts is still quite immature because they carry implicit assumptions about users’ Spark configurations.<br /><br />Like Hadoop, Spark supports a spark-env.sh file (located in $SPARK_CONF_DIR) which defines environment variables for all of the remote Spark workers that are spawned across the cluster.  This file is an ideal place to put the following environment variable definitions:<br />&lt;ul&gt;&lt;li&gt;SPARK_MASTER_IP - the default value for this is <code class="language-plaintext highlighter-rouge">hostname</code> which is generally not a great default on most clusters.  On Rocks, we append “.ibnet” to the hostname to get Spark to operate over the InfiniBand fabric.&lt;/li&gt;&lt;li&gt;SPARK_LOCAL_IP - again, ensure that this is set up to use the correct interface on the cluster.  We append .ibnet on Rocks.&lt;/li&gt;&lt;li&gt;SPARK_HOME, SPARK_PREFIX, and SPARK_CONF_DIR should also be defined here since spark-env.sh will usually override the variables defined by spark-config.sh (see below)&lt;/li&gt;&lt;/ul&gt;$SPARK_HOME/sbin/spark-config.sh is where much of the Spark control scripts’ “intelligence” comes from as far as defining the environment variables that Spark needs to launch.  In particular, spark-config.sh defines the following variables <i>before</i> reading spark-env.sh:<br />&lt;ul&gt;&lt;li&gt;SPARK_PREFIX&lt;/li&gt;&lt;li&gt;SPARK_HOME&lt;/li&gt;&lt;li&gt;SPARK_CONF_DIR&lt;/li&gt;&lt;/ul&gt;The problem is that <b>spark-config.sh will stomp all over anything the user defines</b> for the above variables, and since spark-config.sh is called from within all of the Spark control scripts (both evoked by the user and evoked by sub-processes on remote hosts during the daemon spawning process), trying to get Spark to use non-default values for SPARK_CONF_DIR (e.g., exactly what myHadoop does) gets to be tedious. <br /><br />The Spark developers tried to work around this by having the control scripts call spark-env.sh after spark-config.sh, meaning you should be able to define your own SPARK_CONF_DIR in spark-env.sh.  Unfortunately, this mechanism of calling spark-env.sh after spark-config.sh appears as<br /><br />&lt;pre&gt;. “$sbin/spark-config.sh”<br /><br />if [ -f “${SPARK_CONF_DIR}/spark-env.sh” ]; then<br />  . “${SPARK_CONF_DIR}/spark-env.sh”<br />fi<br />&lt;/pre&gt;<br />That is, spark-config.sh will stomp all over any user-specified SPARK_CONF_DIR, and then use the SPARK_CONF_DIR from spark-config.sh to look for spark-env.sh.  Thus, there is no actual way to get the Spark control scripts (as of version 0.9) to honor the user-specified SPARK_CONF_DIR.  It looks like the latest commits to Spark have started to address this, but a cursory glance over the newest control scripts suggests that this remains broken.<br /><br />Anyway, as a result of this, myHadoop’s Spark integration eschews the Spark control scripts and handles spawning the daemons more directly using the <a href="http://spark.apache.org/docs/0.9.1/spark-standalone.html#starting-a-cluster-manually">manual method of spawning slaves</a>.  Doing this averts the following issues:<br />&lt;ol&gt;&lt;li&gt;start-slaves.sh can’t find any slaves because it always looks for $SPARK_HOME/etc/slaves.  This can be worked around by passing SPARK_SLAVES=$SPARK_CONF_DIR/slaves to start-slaves.sh for a non-default SPARK_CONF_DIR.&lt;/li&gt;&lt;li&gt;stop-master.sh doesn’t do anything useful because you still need to kill -9 the master process by hand.  Not sure why this is the case.&lt;/li&gt;&lt;/ol&gt;&lt;div&gt;<br />&lt;/div&gt;</p>
<h2>Deciphering Spark Errors</h2>
<p>Here are various cryptic stack traces I’ve encountered while working on Spark.  I kept these mostly for myself, but I’ve started meeting people that hit the same problems and thought it might be worthwhile to share the diagnoses I’ve found.<br /><br />In general, Spark seems to work best when used conservatively, but when you start doing things that do not strictly fall within the anticipated use case, things break in strange ways.  For example, if you try to write an RDD with an empty element (e.g., a text file with empty lines), you would get this really crazy error that does not actually say anything meaningful:<br /><br />&lt;pre style="font-size: smaller;"&gt;14/04/30 16:23:07 ERROR Executor: Exception in task ID 19<br />scala.MatchError: 0 (of class java.lang.Integer)<br />     at org.apache.spark.api.python.PythonRDD\(anon$1.read(PythonRDD.scala:110)&lt;br /&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;at org.apache.spark.api.python.PythonRDD\)anon$1.(PythonRDD.scala:153)<br />     at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:96)<br />     at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:241)<br />     at org.apache.spark.rdd.RDD.iterator(RDD.scala:232)<br />     at org.apache.spark.rdd.MappedRDD.compute(MappedRDD.scala:31)<br />     at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:241)<br />     at org.apache.spark.rdd.RDD.iterator(RDD.scala:232)<br />     at org.apache.spark.rdd.MappedRDD.compute(MappedRDD.scala:31)<br />     at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:241)<br />     at org.apache.spark.rdd.RDD.iterator(RDD.scala:232)<br />     at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:109)<br />     at org.apache.spark.scheduler.Task.run(Task.scala:53)<br />     at org.apache.spark.executor.Executor$TaskRunner\(anonfun$run$1.apply$mcV$sp(Executor.scala:213)&lt;br /&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;at org.apache.spark.deploy.SparkHadoopUtil.runAsUser(SparkHadoopUtil.scala:49)&lt;br /&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:178)&lt;br /&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)&lt;br /&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)&lt;br /&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;at java.lang.Thread.run(Thread.java:722)&lt;/pre&gt;&lt;br /&gt;I filed a bug report about this particular problem and the&amp;nbsp;&lt;a href="https://github.com/apache/spark/pull/644"&gt;issue has been fixed&lt;/a&gt;, but it's just one of those edge cases where Spark will fail catastrophically (I had to look at the source code to figure out what "scala.MatchError" meant). &amp;nbsp;Usually you wouldn't be operating on empty data sets, but I discovered this error when I was trying to quickly determine if my Spark slaves were communicating with my master correctly by issuing&lt;br /&gt;&lt;br /&gt;&lt;pre&gt;file = sc.textFile('hdfs://master.ibnet0/user/glock/input.txt')&lt;br /&gt;file.saveAsTextFile('hdfs://master.ibnet0/user/glock/output')&lt;/pre&gt;&lt;br /&gt;That is, simply reading in a file and writing it back out with pyspark would cause catastrophic failure. &amp;nbsp;This is what I meant when I say Spark's still rough around the edges.&lt;br /&gt;&lt;br /&gt;Here are a few more errors I've encountered. &amp;nbsp;They're not problems with Spark, but the stack traces and exceptions thrown can be a little mysterious. &amp;nbsp;I'm pasting it all here for the sake of googlers who may run into these same problems.&lt;br /&gt;&lt;br /&gt;If you try to use Spark built against Hadoop 2 with a Hadoop 1 HDFS, you'll get this IPC error:&lt;br /&gt;&lt;br /&gt;&lt;pre style="font-size: smaller;"&gt;&amp;gt;&amp;gt;&amp;gt; file.saveAsTextFile('hdfs://s12ib:54310/user/glock/gutenberg.out')&lt;br /&gt;Traceback (most recent call last):&lt;br /&gt;&amp;nbsp; File "", line 1, in &lt;br /&gt;&amp;nbsp; File "/home/glock/apps/spark-0.9.0/python/pyspark/rdd.py", line 682, in saveAsTextFile&lt;br /&gt;&amp;nbsp; &amp;nbsp; keyed._jrdd.map(self.ctx._jvm.BytesToString()).saveAsTextFile(path)&lt;br /&gt;&amp;nbsp; File "/home/glock/apps/spark-0.9.0/python/lib/py4j-0.8.1-src.zip/py4j/java_gateway.py", line 537, in __call__&lt;br /&gt;&amp;nbsp; File "/home/glock/apps/spark-0.9.0/python/lib/py4j-0.8.1-src.zip/py4j/protocol.py", line 300, in get_return_value&lt;br /&gt;py4j.protocol.Py4JJavaError: An error occurred while calling o23.saveAsTextFile.&lt;br /&gt;: org.apache.hadoop.ipc.RemoteException: &lt;b&gt;Server IPC version 9 cannot communicate with client version 4&lt;/b&gt;&lt;br /&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;at org.apache.hadoop.ipc.Client.call(Client.java:1070)&lt;br /&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:225)&lt;br /&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;at $Proxy7.getProtocolVersion(Unknown Source)&lt;br /&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;at org.apache.hadoop.ipc.RPC.getProxy(RPC.java:396)&lt;br /&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;at org.apache.hadoop.ipc.RPC.getProxy(RPC.java:379)&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;If your Pythons aren't all the same version across the nodes when Spark workers are instantiated, you might get a cryptic error like this when trying to call the count() method on an RDD:&lt;br /&gt;&lt;br /&gt;&lt;pre style="font-size: smaller;"&gt;14/04/30 16:15:11 ERROR Executor: Exception in task ID 12&lt;br /&gt;org.apache.spark.api.python.PythonException: Traceback (most recent call last):&lt;br /&gt;&amp;nbsp; File "/home/glock/apps/spark-0.9.0-incubating-bin-hadoop1/python/pyspark/worker.py", line 77, in main&lt;br /&gt;&amp;nbsp; &amp;nbsp; serializer.dump_stream(func(split_index, iterator), outfile)&lt;br /&gt;&amp;nbsp; File "/home/glock/apps/spark-0.9.0-incubating-bin-hadoop1/python/pyspark/serializers.py", line 182, in dump_stream&lt;br /&gt;&amp;nbsp; &amp;nbsp; self.serializer.dump_stream(self._batched(iterator), stream)&lt;br /&gt;&amp;nbsp; File "/home/glock/apps/spark-0.9.0-incubating-bin-hadoop1/python/pyspark/serializers.py", line 117, in dump_stream&lt;br /&gt;&amp;nbsp; &amp;nbsp; for obj in iterator:&lt;br /&gt;&amp;nbsp; File "/home/glock/apps/spark-0.9.0-incubating-bin-hadoop1/python/pyspark/serializers.py", line 171, in _batched&lt;br /&gt;&amp;nbsp; &amp;nbsp; for item in iterator:&lt;br /&gt;&amp;nbsp; File "/home/glock/apps/spark-0.9.0-incubating-bin-hadoop1/python/pyspark/rdd.py", line 493, in func&lt;br /&gt;&amp;nbsp; &amp;nbsp; if acc is None:&lt;br /&gt;&lt;b&gt;TypeError: an integer is required&lt;/b&gt;&lt;br /&gt;&lt;br /&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;at org.apache.spark.api.python.PythonRDD\)anon$1.read(PythonRDD.scala:131)<br />     at org.apache.spark.api.python.PythonRDD\(anon$1.(PythonRDD.scala:153)&lt;br /&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:96)&lt;br /&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:241)&lt;br /&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;at org.apache.spark.rdd.RDD.iterator(RDD.scala:232)&lt;br /&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:109)&lt;br /&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;at org.apache.spark.scheduler.Task.run(Task.scala:53)&lt;br /&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;at org.apache.spark.executor.Executor$TaskRunner\)anonfun$run$1.apply$mcV$sp(Executor.scala:213)<br />     at org.apache.spark.deploy.SparkHadoopUtil.runAsUser(SparkHadoopUtil.scala:49)<br />     at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:178)<br />     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)<br />     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)<br />     at java.lang.Thread.run(Thread.java:722)&lt;/pre&gt;<br /><br />If you try to write an RDD to a file with mismatched Python versions, or if you were using anything earlier than Python 2.7 (e.g., 2.6) with any Spark version earlier than 1.0.0, you’d see this:<br /><br />&lt;pre style="font-size: smaller;"&gt;14/04/30 17:53:20 WARN scheduler.TaskSetManager: Loss was due to org.apache.spark.api.python.PythonException<br />org.apache.spark.api.python.PythonException: Traceback (most recent call last):<br />  File “/home/glock/apps/spark-0.9.0-incubating-bin-hadoop2/python/pyspark/worker.py”, line 77, in main<br />    serializer.dump_stream(func(split_index, iterator), outfile)<br />  File “/home/glock/apps/spark-0.9.0-incubating-bin-hadoop2/python/pyspark/serializers.py”, line 117, in dump_stream<br />    for obj in iterator:<br />  File “/home/glock/apps/spark-0.9.0-incubating-bin-hadoop2/python/pyspark/rdd.py”, line 677, in func<br />    if not isinstance(x, basestring):<br /><b>SystemError: unknown opcode</b><br /><br />     at org.apache.spark.api.python.PythonRDD\(anon$1.read(PythonRDD.scala:131)&lt;br /&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;at org.apache.spark.api.python.PythonRDD\)anon$1.(PythonRDD.scala:153)<br />     at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:96)<br />     at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:241)<br />     at org.apache.spark.rdd.RDD.iterator(RDD.scala:232)<br />     at org.apache.spark.rdd.MappedRDD.compute(MappedRDD.scala:31)<br />     at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:241)<br />     at org.apache.spark.rdd.RDD.iterator(RDD.scala:232)<br />     at org.apache.spark.rdd.MappedRDD.compute(MappedRDD.scala:31)<br />     at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:241)<br />     at org.apache.spark.rdd.RDD.iterator(RDD.scala:232)<br />     at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:109)<br />     at org.apache.spark.scheduler.Task.run(Task.scala:53)<br />     at org.apache.spark.executor.Executor$TaskRunner$$anonfun$run$1.apply$mcV$sp(Executor.scala:213)<br />     at org.apache.spark.deploy.SparkHadoopUtil.runAsUser(SparkHadoopUtil.scala:49)<br />     at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:178)<br />     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)<br />     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)<br />     at java.lang.Thread.run(Thread.java:722)&lt;/pre&gt;<br /><br />If your HDFS URI is wrong, the error message actually makes sense.  It is buried quite deeply though.<br /><br />&lt;pre style="font-size: smaller;"&gt;Traceback (most recent call last):<br />  File “”, line 1, in <br />  File “/home/glock/apps/spark-0.9.0-incubating-bin-hadoop2/python/pyspark/rdd.py”, line 682, in saveAsTextFile<br />    keyed._jrdd.map(self.ctx._jvm.BytesToString()).saveAsTextFile(path)<br />  File “/home/glock/apps/spark-0.9.0-incubating-bin-hadoop2/python/lib/py4j-0.8.1-src.zip/py4j/java_gateway.py”, line 537, in <strong>call</strong><br />  File “/home/glock/apps/spark-0.9.0-incubating-bin-hadoop2/python/lib/py4j-0.8.1-src.zip/py4j/protocol.py”, line 300, in get_return_value<br />py4j.protocol.Py4JJavaError: An error occurred while calling o23.saveAsTextFile.<br />: java.lang.IllegalArgumentException: <b>java.net.UnknownHostException: s12ib.ibnet0</b><br />     at org.apache.hadoop.security.SecurityUtil.buildTokenService(SecurityUtil.java:418)<br />     at org.apache.hadoop.hdfs.NameNodeProxies.createNonHAProxy(NameNodeProxies.java:231)<br />     at org.apache.hadoop.hdfs.NameNodeProxies.createProxy(NameNodeProxies.java:139)<br />     at org.apache.hadoop.hdfs.DFSClient.(DFSClient.java:510)<br />     at org.apache.hadoop.hdfs.DFSClient.(DFSClient.java:453)<br />     at org.apache.hadoop.hdfs.DistributedFileSystem.initialize(DistributedFileSystem.java:136)<br />     at org.apache.hadoop.fs.FileSystem.createFileSystem(FileSystem.java:2433)<br />     at org.apache.hadoop.fs.FileSystem.access$200(FileSystem.java:88)<br />     at org.apache.hadoop.fs.FileSystem$Cache.getInternal(FileSystem.java:2467)<br />     at org.apache.hadoop.fs.FileSystem$Cache.get(FileSystem.java:2449)<br />     at org.apache.hadoop.fs.FileSystem.get(FileSystem.java:367)<br />     at org.apache.hadoop.fs.Path.getFileSystem(Path.java:287)<br />     at org.apache.hadoop.mapred.SparkHadoopWriter$.createPathFromString(SparkHadoopWriter.scala:193)<br />     at org.apache.spark.rdd.PairRDDFunctions.saveAsHadoopFile(PairRDDFunctions.scala:685)<br />     at org.apache.spark.rdd.PairRDDFunctions.saveAsHadoopFile(PairRDDFunctions.scala:572)<br />     at org.apache.spark.rdd.RDD.saveAsTextFile(RDD.scala:894)<br />     at org.apache.spark.api.java.JavaRDDLike$class.saveAsTextFile(JavaRDDLike.scala:355)<br />     at org.apache.spark.api.java.JavaRDD.saveAsTextFile(JavaRDD.scala:27)<br />     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)<br />     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)<br />     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)<br />     at java.lang.reflect.Method.invoke(Method.java:597)<br />     at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:231)<br />     at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:379)<br />     at py4j.Gateway.invoke(Gateway.java:259)<br />     at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)<br />     at py4j.commands.CallCommand.execute(CallCommand.java:79)<br />     at py4j.GatewayConnection.run(GatewayConnection.java:207)<br />     at java.lang.Thread.run(Thread.java:619)<br />Caused by: java.net.UnknownHostException: s12ib.ibnet0<br />     … 29 more&lt;/pre&gt;</p>

</div>
<div class="tags-container">
	
</div>
<style>
#uppy {
  position: fixed;
  bottom: 50px;
  right: 50px;
  z-index: 99;
  border: none;
  outline: none;
  background-color: darkturquoise;
  color: black;
  cursor: pointer;
  margin:15px;
  border-radius: 10px;
  width: 100px;
  height: 20px;
}

#returnTop:hover {
  background-color: #555;
}
</style>

<button id="uppy" title="Return to Top" class="btn btn-lg">Back to top</button>

<script>
(function() {

var scrollTop = function() {
    window.scrollTo(0, 0);
};

document.getElementById('uppy').onclick = scrollTop;

})();
</script>


<div class="navigation">
	
		<a class="prev" href="/personal-blog/2014/hadoop-s-uncomfortable-fit-in-hpc/">< Hadoop's Uncomfortable Fit in HPC</a>
	 
	<a class="next" href="/personal-blog/2014/perspectives-on-the-current-state-of-data-intensive-scientific-computing/">Perspectives on the Current State of Data-Intensive Scientific Computing ></a>

</div>

	<div class="footer">
		<span style="padding-right:10px"><font color="red">©️ </font><a href="https://hpc.social"><b>hpc.social</b> community</a></span> 
		| <a style="padding-left:10px; padding-right:10px" href="/personal-blog/archive/">Archive</a>
		| <a style="padding-left:10px; padding-right:10px" href="/personal-blog/">Posts</a>
		| <a style="padding-left:10px; padding-right:10px" href="/personal-blog/about/">About</a>
		| <a style="padding-left:10px; padding-right:10px" href="https://hpc.social/blog">hpc.social blogs</a>
		| <a style="padding-left:37%;" target="_blank" href="https://github.com/hpc-social/personal-blog">Add Your Blog</a>
	</div>
</div>
    <script src="/personal-blog/assets/scripts.js"></script>
    <script type="text/javascript">
        if (localStorage.theme === 'light') {
            document.documentElement.setAttribute('data-theme', 'light');
            document.getElementById('mode-switcher').classList.add('active');
        } else if (localStorage.theme === 'dark' || localStorage.theme === '' || (!('theme' in localStorage))) {
            document.documentElement.setAttribute('data-theme', 'dark');
            document.getElementById('mode-switcher').classList.add('active');
        }
    </script>
</body>
</html>

