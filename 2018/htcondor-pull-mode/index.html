<!DOCTYPE html>
<html lang="en-US" data-theme="light">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0,viewport-fit=cover">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>HTCondor Pull Mode - hpc.social - Aggregated Personal Blog</title>
        <meta name="description" content="Shared personal experiences and stories">
        <meta name="keywords" content="">
        <base href="https://hpc.social/personal-blog" />
        
        <meta content="2018-08-31T18:28:42-06:00" property="article:published_time">
        <meta content="https://hpc.social/about/" property="article:author">
          
        <meta property="og:site_name" content="hpc.social - Aggregated Personal Blog">
        <meta property="og:type" content="article" />
        <meta property="og:url" content="https://hpc.social/personal-blog/2018/htcondor-pull-mode/"/>
        <meta property="og:title" content="HTCondor Pull Mode - hpc.social - Aggregated Personal Blog" />
        <meta property="og:description" content="Shared personal experiences and stories" />
        <meta property="og:image" content="https://hpc.social/personal-blog/assets/images/hpc-social-blue.png"/>
        <meta name="twitter:site" content="@hpc_social" />
        <meta name="twitter:creator" content="@hpc_social" /> 
        <meta name="twitter:card" content="summary"/>
        <meta property="twitter:title" content="HTCondor Pull Mode - hpc.social - Aggregated Personal Blog" />
        <meta property="twitter:description" content="Shared personal experiences and stories" />
        <meta property="twitter:image" content="https://hpc.social/personal-blog/assets/images/hpc-social-blue.png" />
        <link rel="stylesheet" href="/personal-blog/assets/css/highlight.css">

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Catamaran:wght@300&display=swap" rel="stylesheet"> 

        <link rel="stylesheet" href="/personal-blog/assets/css/style.css">
        <link rel="shortcut icon" href="/personal-blog/assets/images/hpc-social-blue.png" />
        <link rel="alternate" type="application/atom+xml" title="hpc.social - Aggregated Personal Blog" href="https://hpc.social/personal-blog/atom.xml">
        <link rel="alternate" type="application/json" title="hpc.social - Aggregated Personal Blog" href="https://hpc.social/personal-blog/feed.json" />
        <link rel="sitemap" type="application/xml" title="sitemap" href="https://hpc.social/personal-blog/sitemap.xml" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebSite","author":{"@type":"Person","name":"hpc.social"},"description":"Shared personal experiences and stories","headline":"hpc.social - Aggregated Personal Blog","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://hpc.social/personal-blog/assets/images/hpc-social-blue.png"},"name":"hpc.social"},"sameAs":["https://twitter.com/","https://github.com/"],"url":"https://hpc.social/personal-blog"}</script>
    </head>
<body>

<div class="container">
	<div class="profile">
		<a href="https://hpc.social/personal-blog/"><img src="/personal-blog/assets/images/hpc-social-blue.png" class="profile-image"></a>
		<div class="profile-about">
			<h2 style="margin-bottom: 0; font-weight: 700;">hpc.social</h2>
			
			
				<a href="https://twitter.com/hpc_social" target="_blank"><img src="/personal-blog/assets/images/icon/twitter.svg" class="social-icon"></a>
			
			
			
			
				<a href="https://github.com/hpc-social" target="_blank"><img src="/personal-blog/assets/images/icon/github.svg" class="social-icon"></a>
			
			
			<a href="/personal-blog/about/"><img src="/personal-blog/assets/images/icon/me.svg" class="social-icon"></a>
			<br>
			High Performance Computing <br> Practitioners <br> and friends /#hpc
			<br>
			<div class="mode" id="mode-switcher" onclick="toggleNightMode();">
				<span></span>
			</div>
		</div>
	</div>
	
<div class="post-header">
	<div class="post-date">31.08.2018  &middot; <span class="reading-time" title="Estimated read time">
  
   2 mins  read </span>
</div>
	<div class="post-share">
		Share:&nbsp; 
		<a href="https://twitter.com/intent/tweet?source=tweetbutton&amp;original_referer=https://hpc.social/htcondor-pull-mode&amp;text=HTCondor Pull Mode - https://hpc.social/htcondor-pull-mode" target="_blank"><img src="https://hpc.social/personal-blog/assets/images/icon/twitter.svg" class="social-icon"></a>
	</div>
</div>

<div class="tags-container" style="padding:10px; font-size:18px; font-style:italic">
        This is a crosspost from &nbsp; <a target="_blank" href="https://derekweitzel.com/">Dereks Web</a>&nbsp;Thoughts from Derek.&nbsp;See the original post&nbsp;<a target="_blank" href="https://derekweitzel.com/2018/08/31/htcondor-pull-mode/">here</a>.</div>

<div class="blog-post-content">
	<h1>HTCondor Pull Mode</h1>
	<p>For a recent project to utilize HPC clusters for HTC workflows, I had to add the ability to transfer the input and output sandboxes to and from HTCondor.  HTCondor already has the ability to spool input files to a SchedD, and pull the output sandbox. These functions are intended to stage jobs to an HTCondor pool.  But, HTCondor did not have the ability to pull jobs from an HTCondor pool.</p>

<p>The anticipated steps for a job pulled from an HTCondor pool:</p>

<ol>
  <li>Download the <strong>input</strong> sandbox</li>
  <li>Submit the job to the local scheduler</li>
  <li>Watch the job status of the job</li>
  <li>Once completed, transfer the <strong>output</strong> sandbox to the origin SchedD</li>
</ol>

<p>The sandboxes are:</p>

<ul>
  <li><strong>Input</strong>:
    <ul>
      <li>Input files</li>
      <li>Executable</li>
      <li>Credentials</li>
    </ul>
  </li>
  <li><strong>Output</strong>:
    <ul>
      <li>Stdout / Stderr from job</li>
      <li>Output files or any files that may have changed while the job ran</li>
    </ul>
  </li>
</ul>

<h2 id="api-additions">API Additions</h2>

<p>In order to transfer the input sandbox and output sandbox, 2 new commands where added to the SchedD, as well as a new client function and python bindings to use them.</p>

<p>The function for transferring input files is:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>transferInputSandbox(constraint, destination)
</code></pre></div>
</div>

<p><code class="language-plaintext highlighter-rouge">jobs</code> is a HTCondor constraint selecting the jobs whose input files should be transferred.  <code class="language-plaintext highlighter-rouge">destination</code> is a directory to put the sandboxes.  The sandboxes will be placed in directories named <code class="language-plaintext highlighter-rouge">destination/&lt;ClusterId&gt;/&lt;ProcId&gt;/</code>.</p>

<p>For transferring output files, the function is:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>transferOutputSandbox( jobs )
</code></pre></div>
</div>

<p>Where <code class="language-plaintext highlighter-rouge">jobs</code> is a list of tuples.  The structure of the tuple is <code class="language-plaintext highlighter-rouge">( classad, sandboxdir )</code>.  <code class="language-plaintext highlighter-rouge">classad</code> is the full classad of the original job, and <code class="language-plaintext highlighter-rouge">sandboxdir</code> is the location of the output sandbox to send.</p>

<h2 id="current-status">Current Status</h2>

<p>I have created a <a href="https://github.com/djw8605/htcondor-pull">repo</a> for an example that uses these functions in order to pull a job from a remote SchedD.</p>

<p>Also, my changes to <a href="https://github.com/djw8605/htcondor/tree/add_sandbox_transfers">HTCondor</a> are in my repo, and I have begun the discussion about merging in my changes.</p>

</div>
<div class="tags-container">
	
</div>
<style>
#uppy {
  position: fixed;
  bottom: 50px;
  right: 50px;
  z-index: 99;
  border: none;
  outline: none;
  background-color: darkturquoise;
  color: black;
  cursor: pointer;
  margin:15px;
  border-radius: 10px;
  width: 100px;
  height: 20px;
}

#returnTop:hover {
  background-color: #555;
}
</style>

<button id="uppy" title="Return to Top" class="btn btn-lg">Back to top</button>

<script>
(function() {

var scrollTop = function() {
    window.scrollTo(0, 0);
};

document.getElementById('uppy').onclick = scrollTop;

})();
</script>


<div class="navigation">
	
		<a class="prev" href="/personal-blog/2018/a-killer-feature-for-scientific-development-frameworks-an-incremental-path-to-maturity/">< A Killer Feature for Scientific Development Frameworks- An Incremental Path To Maturity</a>
	 
	<a class="next" href="/personal-blog/2018/a-hands-on-look-at-gpu-autoconfig-in-ibm-spectrum-lsf/">A hands-on look at GPU "autoconfig" in IBM Spectrum LSF ></a>

</div>

	<div class="footer">
		<span style="padding-right:10px"><font color="red">©️ </font><a href="https://hpc.social"><b>hpc.social</b> community</a></span> 
		| <a style="padding-left:10px; padding-right:10px" href="/personal-blog/archive/">Archive</a>
		| <a style="padding-left:10px; padding-right:10px" href="/personal-blog/">Posts</a>
		| <a style="padding-left:10px; padding-right:10px" href="/personal-blog/about/">About</a>
		| <a style="padding-left:10px; padding-right:10px" href="https://hpc.social/blog">hpc.social blogs</a>
		| <a style="padding-left:37%;" target="_blank" href="https://github.com/hpc-social/personal-blog">Add Your Blog</a>
	</div>
</div>
    <script src="/personal-blog/assets/scripts.js"></script>
    <script type="text/javascript">
        if (localStorage.theme === 'light') {
            document.documentElement.setAttribute('data-theme', 'light');
            document.getElementById('mode-switcher').classList.add('active');
        } else if (localStorage.theme === 'dark' || localStorage.theme === '' || (!('theme' in localStorage))) {
            document.documentElement.setAttribute('data-theme', 'dark');
            document.getElementById('mode-switcher').classList.add('active');
        }
    </script>
</body>
</html>

